all_lviv_hazard_objects=SELECT * FROM public."Lviv_hazard_objects"
by_id_lviv_hazard_objects=SELECT * FROM public."Lviv_hazard_objects" WHERE id = ?
all_hazard_zones=SELECT * FROM public.hazard_zones
by_id_hazard_zones=SELECT * FROM public.hazard_zones where gid = ?

view_hazard_area_view=CREATE OR REPLACE VIEW public.hazard_area_view AS SELECT row_number() OVER (ORDER BY harazd_area.haz_zone_cat) AS id, harazd_area.geom, harazd_area.class_int harazd_area.radius_m FROM ( SELECT 1 AS haz_zone_cat, st_buffer(a.geom, b.radius_m) AS geom, b.class_int b.radius_m FROM lviv_hazard_objects a, hazard_zones b WHERE a.class_int = b.class_int) harazd_area;

view_hazard_area_stat_view=CREATE OR REPLACE VIEW public.hazard_area_stat_view AS SELECT a.id, a.class_int, a.radius_m, a.geom, count(c.*) AS building_count, sum c.f_00_06cou)::integer AS sf_00_06cou, sum(c.f_07_17cou)::integer AS f_07_17cou, sum(c.f_18_24cou)::integer AS f_18_24cou, sum(c.f_25_59cou)::integer AS f_25_59cou, sum(c.f_60_xxcou)::integer AS f_60_xxcou, sum(c.m_00_06cou)::integer AS m_00_06cou, sum(c.m_07_17cou)::integer AS m_07_17cou, sum(c.m_18_24cou)::integer AS m_18_24cou, sum(c.m_25_59cou)::integer AS m_25_59cou, sum(c.m_60_xxcou)::integer AS m_60_xxcou, sum(c.f_00_06cou+f_07_17cou+f_18_24cou+f_25_59cou+f_60_xxcou+m_00_06cou+m_07_17cou+m_18_24cou+m_25_59cou+m_60_xxcou)::integer AS sum_population FROM hazard_area_view a LEFT JOIN sex_age_lviv_population c ON st_within(c.geom, a.geom) GROUP BY a.id, a.class_int, a.geom,a.radius_m;